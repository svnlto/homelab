---
# OpenObserve HelmRelease â€” upstream chart with values from ConfigMap.
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: openobserve
  namespace: openobserve
spec:
  interval: 10m
  releaseName: openobserve
  chart:
    spec:
      chart: openobserve-standalone
      version: "0.60.0"
      sourceRef:
        kind: HelmRepository
        name: openobserve
        namespace: flux-system
  valuesFrom:
    - kind: ConfigMap
      name: openobserve-values
      valuesKey: values.yaml
  install:
    remediation:
      retries: 3
  upgrade:
    remediation:
      retries: 3
  driftDetection:
    mode: enabled
---
# OpenObserve extra manifests (ingress, external-secret) applied via
# Flux Kustomization pointing at the overlay directory.
apiVersion: kustomize.toolkit.fluxcd.io/v1
kind: Kustomization
metadata:
  name: openobserve-extras
  namespace: flux-system
spec:
  interval: 10m
  sourceRef:
    kind: GitRepository
    name: homelab
  path: ./kubernetes/apps/openobserve/overlays/shared
  prune: true
  targetNamespace: openobserve
