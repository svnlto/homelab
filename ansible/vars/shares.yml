---
nfs_shares:
  # All shares use maproot_user: root because arr-stack containers run as root
  # and need full NFS write access. K8s democratic-csi also requires root maproot.

  # Bulk pool
  # Parent + child exports needed: arr-stack mounts parent for cross-directory hardlinks,
  # Jellyfin/Plex mount individual libraries for scoped access.
  - path: /mnt/bulk/media
    comment: "Media + downloads for arr-stack (hardlinks require single dataset)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

  - path: /mnt/bulk/media/movies
    comment: "Movies library (child dataset)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

  - path: /mnt/bulk/media/tv
    comment: "TV library (child dataset)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

  - path: /mnt/bulk/media/music
    comment: "Music library (child dataset)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

  - path: /mnt/bulk/media/books
    comment: "Books library (child dataset)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

  - path: /mnt/bulk/photos
    comment: "Photos for Immich"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

  - path: /mnt/bulk/kubernetes/nfs-dynamic
    comment: "democratic-csi bulk pool (Forgejo registry, large app data)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
      - 10.0.3.0/24
    readonly: false

  - path: /mnt/bulk/signoz-cold
    comment: "Signoz cold storage (30+ days)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
    readonly: false

  - path: /mnt/fast/kubernetes/nfs-dynamic
    comment: "democratic-csi NFS dynamic provisioning"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
      - 10.0.3.0/24
    readonly: false

  - path: /mnt/fast/kubernetes/nfs-static
    comment: "Static PVs for shared configs"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
      - 10.0.3.0/24
    readonly: false

  # Scratch pool
  - path: /mnt/scratch/kubernetes/nfs-dynamic
    comment: "democratic-csi scratch pool (CI cache, ephemeral data)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
      - 10.0.3.0/24
    readonly: false

  - path: /mnt/bulk/backups/proxmox
    comment: "PBS backups (Proxmox Backup Server)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
    readonly: false

  - path: /mnt/scratch/dump
    comment: "Photo dump from remote machine via rsync (K8s CronJob)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
    readonly: false

  - path: /mnt/scratch/downloads
    comment: "Downloads pool (incomplete + complete, sync=disabled)"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 192.168.0.0/24
      - 10.0.1.0/24
    readonly: false

  - path: /mnt/scratch/ci-runners
    comment: "Forgejo CI runner cache and artifacts"
    maproot_user: root
    maproot_group: wheel
    networks:
      - 10.10.10.0/24
      - 10.0.1.0/24
      - 10.0.2.0/24
    readonly: false

smb_shares:
  - name: TimeMachine
    path: /mnt/bulk/backups/timemachine
    purpose: ENHANCED_TIMEMACHINE
    comment: "macOS Time Machine backups"

  - name: Archive
    path: /mnt/bulk/archive
    purpose: DEFAULT_SHARE
    comment: "Manual file archive"

  - name: Media
    path: /mnt/bulk/media
    purpose: DEFAULT_SHARE
    comment: "Movies, TV, music, books"

  - name: Photos
    path: /mnt/bulk/photos
    purpose: DEFAULT_SHARE
    comment: "Photo library"

  - name: Scratch
    path: /mnt/scratch
    purpose: DEFAULT_SHARE
    comment: "Scratch pool"

storage_users:
  - name: media
    uid: 1000
    gid: 1000
    group: media
    home: /nonexistent
    shell: /usr/sbin/nologin

  - name: immich
    uid: 1001
    gid: 1001
    group: immich
    home: /nonexistent
    shell: /usr/sbin/nologin

  - name: dumper
    uid: 1003
    gid: 1000
    group: media
    home: /nonexistent
    shell: /usr/sbin/nologin

storage_groups:
  - name: media
    gid: 1000

  - name: immich
    gid: 1001

# Datasets that get NFSv4 ACLs applied (owner@/group@/everyone@)
acl_datasets:
  - path: /mnt/bulk/media
    uid: 1000
    gid: 1000
    everyone_read: true
  - path: /mnt/bulk/photos
    uid: 1001
    gid: 1000
    everyone_read: true
  - path: /mnt/bulk/archive
    uid: 1002
    gid: 1000
    everyone_read: true
  - path: /mnt/scratch
    uid: 0
    gid: 0
    everyone_read: true
  - path: /mnt/scratch/downloads
    uid: 1000
    gid: 1000
    everyone_read: true
  - path: /mnt/scratch/dump
    uid: 1003
    gid: 1000
    everyone_read: true
  - path: /mnt/bulk/backups/timemachine
    uid: 1002
    gid: 1002
    everyone_read: false
