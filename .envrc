use flake

if command -v op >/dev/null 2>&1; then
  direnv_load op run --no-masking --env-file=.op-env.tpl -- direnv dump

  export PROXMOX_TOKEN_ID="${PROXMOX_TOKEN_ID//\\!/!}"
  export TF_VAR_proxmox_api_token_id="$PROXMOX_TOKEN_ID"
  export TF_VAR_proxmox_api_token_secret="$PROXMOX_TOKEN_SECRET"
  export TF_VAR_mikrotik_username="$MIKROTIK_USERNAME"
  export TF_VAR_mikrotik_password="$MIKROTIK_PASSWORD"
  export AWS_ACCESS_KEY_ID="${B2_KEY_ID:-}"
  export AWS_SECRET_ACCESS_KEY="${B2_APPLICATION_KEY:-}"
else
  echo "âŒ 1Password CLI not found. Install with: brew install 1password-cli"
  echo "   See docs/1password-setup.md for setup instructions."
fi

export SSH_AUTH_SOCK="$HOME/Library/Group Containers/2BUA8C4S2C.com.1password/t/agent.sock"

export OP_ACCOUNT="BMHATEENE5HVVJL3SYKCICPXNI"

export CLAUDE_BASH_MAINTAIN_PROJECT_WORKING_DIR=1
export BASH_MAX_OUTPUT_LENGTH=10000
export BASH_DEFAULT_TIMEOUT_MS=300000

export GITHUB_TOKEN=$(gh auth token 2>/dev/null || echo "")
